{% extends 'base.html' %}

{% block content %}
  <h1>Welcome, {{ request.user.username }}</h1>

  <h2>Your Lectures</h2>
  <table class="lectures-table">
    <thead>
      <tr>
        <th>Title</th>
        <th>Description</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for lecture in lectures %}
      <tr>
        <td>{{ lecture.title }}</td>
        <td>{{ lecture.description }}</td>
        <td>
          <a href="{% url 'edit_lecture' lecture.id %}">Edit</a> | 
          <a href="{% url 'delete_lecture' lecture.id %}">Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="3">No lectures found</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <h2>Add a Lecture</h2>
  <form method="post">
    {% csrf_token %}
    {{ lecture_form.as_p }}
    <button type="submit" name="lecture_form">Add Lecture</button>
  </form>

  {% if availability %}
  <table>
    <thead>
      <tr>
        <th>Day</th>
        <th>Start Time</th>
        <th>End Time</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for avail in availability %}
      <tr>
        <td>{{ avail.day_of_week }}</td>
        <td>{{ avail.start_time }}</td>
        <td>{{ avail.end_time }}</td>
        <td>
          <form method="post">
            {% csrf_token %}
            <input type="hidden" name="availability_id" value="{{ avail.id }}">
            {{ edit_availability_form.as_p }}
            <a href="{% url 'edit_availability' avail.id %}">Edit</a> | 
            <a href="{% url 'delete_availability' avail.id %}">Delete</a>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% endif %}

  <h2>Add Availability</h2>
  <form method="post">
    {% csrf_token %}
    {{ availability_form.as_p }}
    <button type="submit" name="availability_form">Add Availability</button>
  </form>
{% endblock %}
